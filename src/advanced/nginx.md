# NGINX

## NGINX 反向代理

通常，在前后端分离的项目中，为了解决请求跨域问题，一般会选择使用 NGINX 的反向代理功能来代理后端接口。

NGINX 反向代理基本配置方式如下：

```nginx
server {
  listen 80;

  location /path-1 {
    proxy_pass http://backend:8080;
  }
}
```

**location** 指令用于匹配请求路径，语法：

```nginx
location [ = | ~ | ~* | ^~ ] uri { ... }
```

根据符号的不同，uri 可以是一条前缀字符串或正则表达式。

| 符号 | 含义                       | uri       |
|:----:| ------------------------- | --------- |
| =    | 表示精确匹配               | 前缀字符串 |
| ^~   | 表示匹配以 uri 开头的路径   | 前缀字符串 |
| ~    | 表示正则匹配               | 正则表达式 |
| ~*   | 表示正则匹配，但不区分大小写 | 正则表达式 |
| 无   | 表示匹配以 uri 开头的路径   | 前缀字符串 |

当存在多条 **location** 时，匹配规则如下：

1. 检查 **=** 是否命中；
2. 检查 **^~** 是否命中，从前缀长的开始判断；
3. 检查 **~** 和 **~\*** 是否命中，按文件上的配置顺序判断；
4. 检查无符号的规则是否命中，从前缀长的开始判断；
5. 一旦命中则停止后续的判断。

**proxy_pass** 指令用于设置被代理的服务器（协议+域名+端口）